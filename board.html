<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÅ The Chessboard - Your Magical Battlefield!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .header h1 {
            font-size: 3em;
            color: #4a5568;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .back-btn {
            background: linear-gradient(45deg, #ff6b6b, #ffd93d);
            border: none;
            padding: 15px 25px;
            border-radius: 30px;
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            margin-bottom: 20px;
        }

        .back-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }

        .main-board-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin: 30px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .interactive-board {
            display: grid;
            grid-template-columns: 30px repeat(8, 60px) 30px;
            grid-template-rows: 30px repeat(8, 60px) 30px;
            gap: 2px;
            margin: 20px auto;
            background: #8b4513;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            justify-content: center;
        }

        .coordinate {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: #8b4513;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 4px;
        }

        .board-square {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border-radius: 4px;
        }

        .board-square.white {
            background: #f0d9b5;
        }

        .board-square.black {
            background: #b58863;
        }

        .board-square:hover {
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            border: 3px solid #ff6b6b;
        }

        .board-square.highlighted {
            background: #ffeb3b !important;
            animation: pulse 1s infinite;
        }

        .board-square.special {
            background: #4caf50 !important;
        }

        .board-square.center {
            background: #e91e63 !important;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .board-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .control-btn {
            background: linear-gradient(45deg, #00b894, #00cec9);
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .control-btn.active {
            background: linear-gradient(45deg, #e17055, #fdcb6e);
        }

        .info-section {
            background: rgba(255, 255, 255, 0.95);
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .info-section h2 {
            color: #2d3436;
            font-size: 2.2em;
            margin-bottom: 20px;
            text-align: center;
        }

        .board-facts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .fact-card {
            background: linear-gradient(135deg, #a8edea, #fed6e3);
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .fact-card:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
        }

        .fact-card .emoji {
            font-size: 3em;
            margin-bottom: 15px;
        }

        .fact-card h3 {
            color: #2d3436;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        .coordinate-game {
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .coordinate-game h3 {
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8em;
        }

        .game-challenge {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin: 15px 0;
            text-align: center;
        }

        .challenge-question {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .answer-input {
            padding: 12px 20px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            margin: 10px;
            text-align: center;
            font-weight: bold;
        }

        .check-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s ease;
        }

        .check-btn:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .setup-demo {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .setup-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .setup-step {
            background: rgba(255, 255, 255, 0.2);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .setup-step:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
        }

        .step-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .board-patterns {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .pattern-demo {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .pattern-card {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .pattern-card:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .mini-pattern-board {
            display: grid;
            grid-template-columns: repeat(4, 20px);
            grid-template-rows: repeat(4, 20px);
            gap: 1px;
            margin: 15px auto;
            justify-content: center;
        }

        .pattern-square {
            width: 20px;
            height: 20px;
            border-radius: 2px;
        }

        .pattern-square.white {
            background: #f0d9b5;
        }

        .pattern-square.black {
            background: #b58863;
        }

        .quiz-section {
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            padding: 30px;
            border-radius: 20px;
            margin: 25px 0;
        }

        .quiz-question {
            background: rgba(255, 255, 255, 0.9);
            color: #333;
            padding: 20px;
            border-radius: 12px;
            margin: 15px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .quiz-question:hover {
            background: rgba(255, 255, 255, 1);
            transform: scale(1.02);
        }

        .quiz-question.correct {
            background: #d4edda;
            border: 3px solid #28a745;
        }

        .quiz-question.incorrect {
            background: #f8d7da;
            border: 3px solid #dc3545;
        }

        .celebration {
            text-align: center;
            font-size: 2em;
            margin: 20px 0;
            opacity: 0;
            transition: all 0.5s ease;
        }

        .celebration.show {
            opacity: 1;
            animation: bounce 1s ease-in-out;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        @media (max-width: 768px) {
            .interactive-board {
                grid-template-columns: 25px repeat(8, 45px) 25px;
                grid-template-rows: 25px repeat(8, 45px) 25px;
            }
            
            .board-square {
                width: 45px;
                height: 45px;
                font-size: 24px;
            }
            
            .coordinate {
                font-size: 12px;
            }
            
            .header h1 {
                font-size: 2.2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="back-btn" onclick="goBack()">‚¨ÖÔ∏è Back to Chess Kingdom</button>
        
        <div class="header">
            <h1>üèÅ The Magical Chessboard!</h1>
            <p style="font-size: 1.2em; color: #666;">Explore your 64-square battlefield and master its secrets!</p>
        </div>

        <div class="main-board-section">
            <h2>üéØ Interactive Chess Board Explorer</h2>
            <p style="margin-bottom: 20px;">Click on squares to explore! Use the buttons below to discover board secrets.</p>
            
            <div class="board-controls">
                <button class="control-btn" onclick="showBoardFeature('coordinates')">üìç Show Coordinates</button>
                <button class="control-btn" onclick="showBoardFeature('center')">üéØ Center Squares</button>
                <button class="control-btn" onclick="showBoardFeature('corners')">üìê Corner Squares</button>
                <button class="control-btn" onclick="showBoardFeature('files')">üìä Files (Columns)</button>
                <button class="control-btn" onclick="showBoardFeature('ranks')">üìà Ranks (Rows)</button>
                <button class="control-btn" onclick="showBoardFeature('diagonals')">‚ö° Diagonals</button>
                <button class="control-btn" onclick="resetBoard()">üîÑ Reset Board</button>
            </div>
            
            <div class="interactive-board" id="chessBoard">
                <!-- Board will be generated by JavaScript -->
            </div>
            
            <div id="boardInfo" style="margin-top: 20px; font-size: 1.1em; font-weight: bold; color: #2d3436;">
                Click anywhere on the board to start exploring!
            </div>
        </div>

        <div class="info-section">
            <h2>üìö Board Knowledge Base</h2>
            <div class="board-facts">
                <div class="fact-card" onclick="showFactDetail('squares')">
                    <div class="emoji">üî¢</div>
                    <h3>64 Squares</h3>
                    <p>The chessboard has exactly 64 squares in an 8√ó8 grid pattern!</p>
                </div>
                
                <div class="fact-card" onclick="showFactDetail('colors')">
                    <div class="emoji">üé®</div>
                    <h3>Two Colors</h3>
                    <p>Alternating light and dark squares create the checkered pattern!</p>
                </div>
                
                <div class="fact-card" onclick="showFactDetail('corner')">
                    <div class="emoji">üìê</div>
                    <h3>White Corner Rule</h3>
                    <p>Always place the board with a light square in the bottom-right corner!</p>
                </div>
                
                <div class="fact-card" onclick="showFactDetail('coordinates')">
                    <div class="emoji">üó∫Ô∏è</div>
                    <h3>Square Names</h3>
                    <p>Every square has a unique name using letters (a-h) and numbers (1-8)!</p>
                </div>
                
                <div class="fact-card" onclick="showFactDetail('files')">
                    <div class="emoji">üìä</div>
                    <h3>8 Files</h3>
                    <p>Vertical columns are called "files" and labeled with letters a-h!</p>
                </div>
                
                <div class="fact-card" onclick="showFactDetail('ranks')">
                    <div class="emoji">üìà</div>
                    <h3>8 Ranks</h3>
                    <p>Horizontal rows are called "ranks" and numbered 1-8!</p>
                </div>
            </div>
        </div>

        <div class="coordinate-game">
            <h3>üéÆ Coordinate Challenge Game!</h3>
            <div class="game-challenge">
                <div class="challenge-question" id="challengeQuestion">
                    Find the square: e4
                </div>
                <input type="text" class="answer-input" id="coordinateAnswer" placeholder="Click on the board!" readonly>
                <br>
                <button class="check-btn" onclick="checkCoordinate()">‚úÖ Check Answer</button>
                <button class="check-btn" onclick="newChallenge()">üé≤ New Challenge</button>
                <div id="challengeResult" style="margin-top: 15px; font-weight: bold;"></div>
                <div id="challengeScore" style="margin-top: 10px;">Score: 0/0</div>
            </div>
        </div>

        <div class="setup-demo">
            <h2 style="text-align: center; margin-bottom: 25px;">üèóÔ∏è How to Set Up Your Board</h2>
            <div class="setup-steps">
                <div class="setup-step" onclick="showSetupStep(1)">
                    <div class="step-number">1Ô∏è‚É£</div>
                    <h4>Position the Board</h4>
                    <p>White square goes in the bottom-right corner!</p>
                </div>
                
                <div class="setup-step" onclick="showSetupStep(2)">
                    <div class="step-number">2Ô∏è‚É£</div>
                    <h4>Place the Rooks</h4>
                    <p>Rooks go in the corners (a1, h1, a8, h8)!</p>
                </div>
                
                <div class="setup-step" onclick="showSetupStep(3)">
                    <div class="step-number">3Ô∏è‚É£</div>
                    <h4>Add Knights</h4>
                    <p>Knights go next to rooks (b1, g1, b8, g8)!</p>
                </div>
                
                <div class="setup-step" onclick="showSetupStep(4)">
                    <div class="step-number">4Ô∏è‚É£</div>
                    <h4>Place Bishops</h4>
                    <p>Bishops go next to knights (c1, f1, c8, f8)!</p>
                </div>
                
                <div class="setup-step" onclick="showSetupStep(5)">
                    <div class="step-number">5Ô∏è‚É£</div>
                    <h4>Queen on Her Color</h4>
                    <p>White queen on d1 (light), black queen on d8 (dark)!</p>
                </div>
                
                <div class="setup-step" onclick="showSetupStep(6)">
                    <div class="step-number">6Ô∏è‚É£</div>
                    <h4>King Takes the Rest</h4>
                    <p>Kings go on e1 and e8, the remaining squares!</p>
                </div>
            </div>
        </div>

        <div class="board-patterns">
            <h2 style="text-align: center; margin-bottom: 25px;">üé® Board Patterns & Strategies</h2>
            <div class="pattern-demo">
                <div class="pattern-card" onclick="showPattern('center')">
                    <h4>üéØ Center Control</h4>
                    <div class="mini-pattern-board">
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square" style="background: #4caf50;"></div>
                        <div class="pattern-square" style="background: #4caf50;"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square" style="background: #4caf50;"></div>
                        <div class="pattern-square" style="background: #4caf50;"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                    </div>
                    <p>Control the center squares e4, e5, d4, d5!</p>
                </div>
                
                <div class="pattern-card" onclick="showPattern('diagonals')">
                    <h4>‚ö° Long Diagonals</h4>
                    <div class="mini-pattern-board">
                        <div class="pattern-square" style="background: #ff9800;"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square" style="background: #ff9800;"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square" style="background: #ff9800;"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square" style="background: #ff9800;"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square" style="background: #ff9800;"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                    </div>
                    <p>Long diagonals are highways for bishops!</p>
                </div>
                
                <div class="pattern-card" onclick="showPattern('edges')">
                    <h4>üè∞ Edge Control</h4>
                    <div class="mini-pattern-board">
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                        <div class="pattern-square" style="background: #e91e63;"></div>
                    </div>
                    <p>Rooks love the edges and open files!</p>
                </div>
                
                <div class="pattern-card" onclick="showPattern('safety')">
                    <h4>üõ°Ô∏è Safe Squares</h4>
                    <div class="mini-pattern-board">
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square white"></div>
                        <div class="pattern-square black"></div>
                        <div class="pattern-square" style="background: #2196f3;"></div>
                        <div class="pattern-square" style="background: #2196f3;"></div>
                        <div class="pattern-square" style="background: #2196f3;"></div>
                        <div class="pattern-square black"></div>
                    </div>
                    <p>Keep your king safe in the back rank!</p>
                </div>
            </div>
        </div>

        <div class="quiz-section">
            <h2 style="text-align: center; margin-bottom: 25px;">üß† Board Knowledge Quiz!</h2>
            
            <div class="quiz-question" onclick="checkBoardQuiz(this, true)">
                <strong>How many squares are on a chessboard?</strong><br>
                <span style="font-size: 0.9em;">A) 64 squares</span>
            </div>
            
            <div class="quiz-question" onclick="checkBoardQuiz(this, false)">
                <strong>How many squares are on a chessboard?</strong><br>
                <span style="font-size: 0.9em;">B) 48 squares</span>
            </div>
            
            <div class="quiz-question" onclick="checkBoardQuiz(this, true)">
                <strong>Which corner should have a white square?</strong><br>
                <span style="font-size: 0.9em;">A) Bottom-right corner</span>
            </div>
            
            <div class="quiz-question" onclick="checkBoardQuiz(this, false)">
                <strong>Which corner should have a white square?</strong><br>
                <span style="font-size: 0.9em;">B) Bottom-left corner</span>
            </div>
            
            <div class="quiz-question" onclick="checkBoardQuiz(this, true)">
                <strong>What are the vertical columns called?</strong><br>
                <span style="font-size: 0.9em;">A) Files</span>
            </div>
            
            <div class="quiz-question" onclick="checkBoardQuiz(this, false)">
                <strong>What are the vertical columns called?</strong><br>
                <span style="font-size: 0.9em;">B) Ranks</span>
            </div>
        </div>

        <div class="celebration" id="celebration"></div>

        <div style="text-align: center; margin: 30px 0;">
            <button onclick="completeBoard()" class="back-btn" style="font-size: 1.2em; padding: 20px 35px;">
                ‚úÖ I'm a Board Master!
            </button>
        </div>
    </div>

    <script>
        let currentChallenge = null;
        let challengeScore = 0;
        let challengeAttempts = 0;
        let boardFeaturesExplored = new Set();
        let quizAnswered = new Set();
        let factsLearned = new Set();
        let selectedSquare = null;

        const boardInfo = {
            squares: "A chessboard has 64 squares arranged in an 8√ó8 grid. That's 32 light squares and 32 dark squares, perfectly alternating!",
            colors: "The alternating light and dark squares create the iconic checkered pattern. This helps players see the board clearly and plan their moves!",
            corner: "The golden rule: 'White on the right!' Always set up the board with a light square in the bottom-right corner. This ensures proper piece placement!",
            coordinates: "Each square has a unique address! Files (columns) are labeled a-h from left to right, and ranks (rows) are numbered 1-8 from bottom to top.",
            files: "Files are the vertical columns labeled a, b, c, d, e, f, g, h. They're like streets running up and down the board!",
            ranks: "Ranks are the horizontal rows numbered 1, 2, 3, 4, 5, 6, 7, 8. They're like avenues running across the board!"
        };

        function goBack() {
            window.history.back();
        }

        function createBoard() {
            const board = document.getElementById('chessBoard');
            board.innerHTML = '';
            
            // Create coordinate labels and squares
            for (let row = 0; row <= 9; row++) {
                for (let col = 0; col <= 9; col++) {
                    const element = document.createElement('div');
                    
                    if (row === 0 || row === 9) {
                        if (col >= 1 && col <= 8) {
                            element.className = 'coordinate';
                            element.textContent = String.fromCharCode(96 + col); // a-h
                        }
                    } else if (col === 0 || col === 9) {
                        if (row >= 1 && row <= 8) {
                            element.className = 'coordinate';
                            element.textContent = 9 - row; // 8-1
                        }
                    } else {
                        // Regular board square
                        element.className = `board-square ${(row + col) % 2 === 0 ? 'black' : 'white'}`;
                        element.dataset.file = String.fromCharCode(96 + col); // a-h
                        element.dataset.rank = 9 - row; // 8-1
                        element.dataset.square = element.dataset.file + element.dataset.rank;
                        element.onclick = () => selectSquare(element);
                    }
                    
                    board.appendChild(element);
                }
            }
        }

        function selectSquare(square) {
            // Remove previous selection
            document.querySelectorAll('.board-square').forEach(s => {
                s.style.border = 'none';
            });
            
            // Highlight selected square
            square.style.border = '4px solid #ff6b6b';
            selectedSquare = square.dataset.square;
            
            // Update info
            const info = document.getElementById('boardInfo');
            info.innerHTML = `
                <strong>Selected:</strong> ${square.dataset.square.toUpperCase()} 
                <span style="color: #666;">(File: ${square.dataset.file}, Rank: ${square.dataset.rank})</span><br>
                <span style="color: ${square.classList.contains('white') ? '#8b4513' : '#654321'};">
                    ${square.classList.contains('white') ? 'Light Square' : 'Dark Square'}
                </span>
            `;
            
            // If there's an active challenge, check the answer
            if (currentChallenge && document.getElementById('coordinateAnswer')) {
                document.getElementById('coordinateAnswer').value = square.dataset.square;
            }
            
            showCelebration(`üéØ You selected ${square.dataset.square.toUpperCase()}!`);
        }

        function showBoardFeature(feature) {
            boardFeaturesExplored.add(feature);
            
            // Reset all squares
            document.querySelectorAll('.board-square').forEach(square => {
                square.classList.remove('highlighted', 'special', 'center');
            });
            
            // Remove active class from all buttons
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            event.target.classList.add('active');
            
            const squares = document.querySelectorAll('.board-square');
            
            switch(feature) {
                case 'coordinates':
                    showCelebration('üìç Every square has a unique coordinate! Click any square to see its name.');
                    break;
                    
                case 'center':
                    squares.forEach(square => {
                        if (['d4', 'd5', 'e4', 'e5'].includes(square.dataset.square)) {
                            square.classList.add('center');
                        }
                    });
                    showCelebration('üéØ The center squares are the most important! Control them to dominate the game!');
                    break;
                    
                case 'corners':
                    squares.forEach(square => {
                        if (['a1', 'a8', 'h1', 'h8'].includes(square.dataset.square)) {
                            square.classList.add('special');
                        }
                    });
                    showCelebration('üìê The four corners are where rooks start! These are powerful positions.');
                    break;
                    
                case 'files':
                    const randomFile = String.fromCharCode(97 + Math.floor(Math.random() * 8));
                    squares.forEach(square => {
                        if (square.dataset.file === randomFile) {
                            square.classList.add('highlighted');
                        }
                    });
                    showCelebration(`üìä Highlighting the ${randomFile}-file! Files are vertical columns.`);
                    break;
                    
                case 'ranks':
                    const randomRank = Math.floor(Math.random() * 8) + 1;
                    squares.forEach(square => {
                        if (square.dataset.rank == randomRank) {
                            square.classList.add('highlighted');
                        }
                    });
                    showCelebration(`üìà Highlighting rank ${randomRank}! Ranks are horizontal rows.`);
                    break;
                    
                case 'diagonals':
                    squares.forEach(square => {
                        const file = square.dataset.file.charCodeAt(0) - 96;
                        const rank = parseInt(square.dataset.rank);
                        // Main diagonals
                        if (file === rank || file + rank === 9) {
                            square.classList.add('highlighted');
                        }
                    });
                    showCelebration('‚ö° Long diagonals highlighted! Bishops love these paths!');
                    break;
            }
        }

        function resetBoard() {
            document.querySelectorAll('.board-square').forEach(square => {
                square.classList.remove('highlighted', 'special', 'center');
                square.style.border = 'none';
            });
            
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.getElementById('boardInfo').textContent = 'Click anywhere on the board to start exploring!';
            selectedSquare = null;
        }

        function showFactDetail(fact) {
            factsLearned.add(fact);
            showCelebration(`üìö ${boardInfo[fact]}`);
        }

        function newChallenge() {
            const files = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'];
            const ranks = ['1', '2', '3', '4', '5', '6', '7', '8'];
            
            const randomFile = files[Math.floor(Math.random() * files.length)];
            const randomRank = ranks[Math.floor(Math.random() * ranks.length)];
            
            currentChallenge = randomFile + randomRank;
            
            document.getElementById('challengeQuestion').textContent = `Find the square: ${currentChallenge}`;
            document.getElementById('coordinateAnswer').value = '';
            document.getElementById('challengeResult').textContent = '';
            
            // Highlight the target square temporarily
            const targetSquare = document.querySelector(`[data-square="${currentChallenge}"]`);
            if (targetSquare) {
                targetSquare.classList.add('highlighted');
                setTimeout(() => {
                    targetSquare.classList.remove('highlighted');
                }, 1000);
            }
        }

        function checkCoordinate() {
            if (!currentChallenge) {
                newChallenge();
                return;
            }
            
            const userAnswer = document.getElementById('coordinateAnswer').value;
            const result = document.getElementById('challengeResult');
            
            challengeAttempts++;
            
            if (userAnswer.toLowerCase() === currentChallenge.toLowerCase()) {
                challengeScore++;
                result.innerHTML = 'üéâ Correct! Great job!';
                result.style.color = '#28a745';
                showCelebration('üèÜ Perfect! You found the right square!');
            } else {
                result.innerHTML = `‚ùå Not quite! The answer was ${currentChallenge.toUpperCase()}`;
                result.style.color = '#dc3545';
            }
            
            document.getElementById('challengeScore').textContent = `Score: ${challengeScore}/${challengeAttempts}`;
            
            // Auto-start new challenge after 2 seconds
            setTimeout(() => {
                newChallenge();
            }, 2000);
        }

        function showSetupStep(step) {
            resetBoard();
            const squares = document.querySelectorAll('.board-square');
            
            switch(step) {
                case 1:
                    document.querySelector('[data-square="h1"]').classList.add('special');
                    showCelebration('1Ô∏è‚É£ White square in bottom-right corner (h1)! This is the golden rule!');
                    break;
                    
                case 2:
                    ['a1', 'h1', 'a8', 'h8'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('special');
                    });
                    showCelebration('2Ô∏è‚É£ Rooks go in all four corners! These are the castle towers!');
                    break;
                    
                case 3:
                    ['b1', 'g1', 'b8', 'g8'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('highlighted');
                    });
                    showCelebration('3Ô∏è‚É£ Knights go next to the rooks! Ready to jump into action!');
                    break;
                    
                case 4:
                    ['c1', 'f1', 'c8', 'f8'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('center');
                    });
                    showCelebration('4Ô∏è‚É£ Bishops go next to the knights! Diagonal wizards in position!');
                    break;
                    
                case 5:
                    ['d1', 'd8'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('special');
                    });
                    showCelebration('5Ô∏è‚É£ Queens go on their own color! White queen on light, black queen on dark!');
                    break;
                    
                case 6:
                    ['e1', 'e8'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('highlighted');
                    });
                    showCelebration('6Ô∏è‚É£ Kings take the remaining squares! The most important pieces!');
                    break;
            }
        }

        function showPattern(pattern) {
            resetBoard();
            const squares = document.querySelectorAll('.board-square');
            
            switch(pattern) {
                case 'center':
                    ['d4', 'd5', 'e4', 'e5'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('center');
                    });
                    showCelebration('üéØ Center control is key! These four squares are the heart of the board!');
                    break;
                    
                case 'diagonals':
                    squares.forEach(square => {
                        const file = square.dataset.file.charCodeAt(0) - 96;
                        const rank = parseInt(square.dataset.rank);
                        if (file === rank || file + rank === 9) {
                            square.classList.add('highlighted');
                        }
                    });
                    showCelebration('‚ö° Long diagonals are bishop highways! Control these for diagonal domination!');
                    break;
                    
                case 'edges':
                    squares.forEach(square => {
                        const file = square.dataset.file;
                        const rank = square.dataset.rank;
                        if (file === 'a' || file === 'h' || rank === '1' || rank === '8') {
                            square.classList.add('special');
                        }
                    });
                    showCelebration('üè∞ Edge squares are perfect for rooks! They control entire files and ranks!');
                    break;
                    
                case 'safety':
                    ['a1', 'b1', 'c1', 'f1', 'g1', 'h1', 'a8', 'b8', 'c8', 'f8', 'g8', 'h8'].forEach(square => {
                        document.querySelector(`[data-square="${square}"]`).classList.add('highlighted');
                    });
                    showCelebration('üõ°Ô∏è Back ranks are safety zones! Keep your king protected here!');
                    break;
            }
        }

        function checkBoardQuiz(element, isCorrect) {
            if (element.classList.contains('correct') || element.classList.contains('incorrect')) {
                return; // Already answered
            }
            
            quizAnswered.add(element);
            
            if (isCorrect) {
                element.classList.add('correct');
                element.innerHTML += '<div style="margin-top: 10px; color: #28a745; font-weight: bold;">‚úÖ Correct! Excellent!</div>';
                showCelebration('üéâ Right answer! You\'re mastering the board!');
            } else {
                element.classList.add('incorrect');
                element.innerHTML += '<div style="margin-top: 10px; color: #dc3545; font-weight: bold;">‚ùå Not quite! Keep learning!</div>';
            }
        }

        function completeBoard() {
            const totalItems = 6 + 6 + 6; // features + facts + quiz
            const completedItems = boardFeaturesExplored.size + factsLearned.size + quizAnswered.size;
            
            if (completedItems >= totalItems * 0.7) { // 70% completion
                showCelebration('üèÜ Congratulations! You\'ve mastered the chessboard! Ready for piece movements?');
                
                // Add confetti effect
                for (let i = 0; i < 50; i++) {
                    createConfetti();
                }
                
                setTimeout(() => {
                    if (confirm('üöÄ Ready to learn how pieces move? Click OK to continue your chess journey!')) {
                        alert('üéØ Awesome! In a real chess app, this would take you to learn piece movements!');
                    }
                }, 2000);
            } else {
                showCelebration('üìö Explore more board features and take the quiz to become a true board master!');
            }
        }

        function showCelebration(message) {
            const celebration = document.getElementById('celebration');
            celebration.textContent = message;
            celebration.classList.add('show');
            
            setTimeout(() => {
                celebration.classList.remove('show');
            }, 4000);
        }

        function createConfetti() {
            const symbols = ['üèÅ', 'üéØ', 'üìç', 'üéâ', 'üéä', '‚≠ê', 'üèÜ', 'üëë'];
            const confetti = document.createElement('div');
            confetti.textContent = symbols[Math.floor(Math.random() * symbols.length)];
            confetti.style.position = 'fixed';
            confetti.style.fontSize = '25px';
            confetti.style.left = Math.random() * window.innerWidth + 'px';
            confetti.style.top = '-50px';
            confetti.style.zIndex = '1000';
            confetti.style.pointerEvents = 'none';
            
            document.body.appendChild(confetti);
            
            const animation = confetti.animate([
                { transform: 'translateY(-50px) rotate(0deg)', opacity: 1 },
                { transform: `translateY(${window.innerHeight + 50}px) rotate(360deg)`, opacity: 0 }
            ], {
                duration: 2000 + Math.random() * 1000,
                easing: 'ease-out'
            });
            
            animation.onfinish = () => {
                confetti.remove();
            };
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            createBoard();
            newChallenge();
            showCelebration('üèÅ Welcome to the chessboard! Explore every corner of your battlefield!');
        });
    </script>
</body>
</html>